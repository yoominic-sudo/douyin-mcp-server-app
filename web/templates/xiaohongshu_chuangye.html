<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2026 你是打工型还是创业型</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    :root {
      --blue-main: #0081d5;
      --blue-deep: #006fb9;
      --blue-dark: #005a97;
      --white-soft: rgba(255, 255, 255, 0.92);
    }
    .glass-card {
      background: rgba(255, 255, 255, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.75);
      box-shadow: 0 16px 40px rgba(0, 63, 120, 0.2);
      backdrop-filter: blur(8px);
    }
    .hero-wrap {
      background: linear-gradient(180deg, #0091e9 0%, #007dc9 48%, #006db3 100%);
      box-shadow: 0 20px 50px rgba(0, 63, 120, 0.35);
    }
    .hero-title {
      font-weight: 900;
      line-height: 0.95;
      letter-spacing: 0.01em;
      text-shadow: 0 8px 18px rgba(0, 52, 107, 0.32);
    }
    .hero-illustration {
      position: absolute;
      border-radius: 999px;
      border: 2px solid rgba(255, 255, 255, 0.45);
      background: rgba(255, 255, 255, 0.16);
      backdrop-filter: blur(4px);
    }
  </style>
</head>
<body class="min-h-screen text-white" x-data="quizApp()" x-init="init()">
  <div class="fixed inset-0 -z-10 bg-[radial-gradient(circle_at_50%_18%,rgba(255,255,255,0.16),transparent_38%),linear-gradient(180deg,#0997ef_0%,#007fcd_52%,#0065a8_100%)]"></div>

  <main class="mx-auto max-w-3xl px-4 py-6 sm:py-10">
    <header class="hero-wrap relative mb-6 overflow-hidden rounded-3xl px-6 py-8 sm:px-9 sm:py-10">
      <div class="hero-illustration -left-6 -top-8 h-24 w-24"></div>
      <div class="hero-illustration right-4 top-4 h-14 w-14"></div>
      <div class="hero-illustration -bottom-8 right-12 h-28 w-28"></div>
      <div class="hero-title relative text-center text-white">
        <p class="text-[44px] sm:text-[72px]">2026</p>
        <p class="text-[50px] sm:text-[90px]">打工型</p>
        <p class="text-[50px] sm:text-[90px]">还是创业型</p>
      </div>
      <p class="mt-4 text-center text-sm leading-6 text-white/90 sm:text-base">根据你的风险偏好、执行风格与现金流安全感，给你一条更贴近现实的职业路线。</p>
      <div class="relative mt-5 flex items-center justify-center gap-3 text-xs text-white/95">
        <span class="rounded-full border border-white/40 bg-white/15 px-3 py-1">🧭 方向判断</span>
        <span class="rounded-full border border-white/40 bg-white/15 px-3 py-1">📈 成长路径</span>
        <span class="rounded-full border border-white/40 bg-white/15 px-3 py-1">💼 职业画像</span>
      </div>
    </header>

    <section x-show="!started && !lockState" class="glass-card rounded-3xl p-5 text-slate-900 sm:p-7" x-transition>
      <h2 class="text-xl font-bold">首次测评免费</h2>
      <p class="mt-2 text-sm text-slate-600">本次可免费测 1 次。后续每次通过看广告解锁 1 次测评机会。</p>
      <div class="mt-4 rounded-xl border border-sky-100 bg-sky-50 p-3 text-sm">
        <p>免费剩余：<span class="font-bold" x-text="quota.free_remaining || 0"></span> 次</p>
        <p>广告次数：<span class="font-bold" x-text="quota.ad_credits || 0"></span> 次</p>
      </div>
      <button @click="startQuiz" class="mt-5 h-11 rounded-xl bg-gradient-to-r from-sky-500 to-cyan-500 px-5 text-sm font-semibold text-white">开始测评</button>
    </section>

    <section x-show="lockState" class="glass-card rounded-3xl p-5 text-slate-900 sm:p-7" x-transition>
      <h2 class="text-xl font-bold">本次次数已用完</h2>
      <p class="mt-2 text-sm text-slate-600">看一段广告即可再解锁 1 次测评机会。</p>
      <button @click="watchAdUnlock" class="mt-5 h-11 rounded-xl bg-gradient-to-r from-pink-500 to-orange-400 px-5 text-sm font-semibold text-white">看广告解锁 1 次</button>
    </section>

    <section x-show="started && !finished" class="glass-card rounded-3xl p-5 text-slate-900 sm:p-7" x-transition>
      <div class="mb-4 flex items-center justify-between text-xs text-slate-600">
        <span>进度 <span x-text="answeredCount"></span>/<span x-text="totalStepsEstimate"></span></span>
        <span x-text="Math.round(progress * 100) + '%'" class="font-semibold text-slate-800"></span>
      </div>
      <div class="h-2 overflow-hidden rounded-full bg-slate-200/70">
        <div class="h-full rounded-full bg-gradient-to-r from-sky-400 via-blue-400 to-cyan-300 transition-all duration-500" :style="`width:${Math.max(progress * 100, 6)}%`"></div>
      </div>

      <div class="mt-6 flex gap-3">
        <div class="hidden w-14 shrink-0 flex-col gap-2 sm:flex">
          <div class="rounded-xl border border-sky-200 bg-sky-50 p-2 text-center text-lg">🧑‍💼</div>
          <div class="rounded-xl border border-sky-200 bg-sky-50 p-2 text-center text-lg">🚀</div>
          <div class="rounded-xl border border-sky-200 bg-sky-50 p-2 text-center text-lg">📈</div>
        </div>
        <div class="flex-1">
          <p class="text-xs uppercase tracking-[0.2em] text-sky-700" x-text="currentQuestion.group"></p>
          <h2 class="mt-2 text-lg font-semibold text-slate-900 sm:text-xl" x-text="currentQuestion.title"></h2>
          <p class="mt-1 text-sm text-slate-600" x-text="currentQuestion.desc"></p>
        </div>
      </div>

      <div class="mt-5 grid gap-3">
        <template x-for="opt in currentQuestion.options" :key="opt.id">
          <button
            @click="selectOption(opt)"
            class="w-full rounded-2xl border border-sky-200 bg-white px-4 py-3 text-left transition hover:border-sky-400 hover:bg-sky-50"
          >
            <div class="flex items-start gap-3">
              <span class="mt-0.5 inline-flex h-6 w-6 items-center justify-center rounded-full border border-sky-300 text-xs text-sky-700" x-text="opt.id"></span>
              <div>
                <p class="text-sm font-medium text-slate-800" x-text="opt.text"></p>
                <p class="mt-1 text-xs text-slate-500" x-show="opt.tip" x-text="opt.tip"></p>
              </div>
            </div>
          </button>
        </template>
      </div>
    </section>

    <section x-show="finished" x-transition class="glass-card relative overflow-hidden rounded-3xl p-5 sm:p-7">
      <div class="inline-flex items-center gap-2 rounded-full border border-pink-200 bg-pink-50 px-3 py-1 text-xs font-semibold text-pink-700">
        <span>网红测评结果已出炉</span>
      </div>
      <div class="mt-4 rounded-2xl bg-gradient-to-r from-sky-600 to-blue-600 p-4 text-white">
        <p class="text-xs uppercase tracking-wider text-white/80">你的类型</p>
        <h2 class="mt-1 text-3xl font-extrabold sm:text-4xl" x-text="result.title"></h2>
        <p class="mt-2 text-sm text-white/90" x-text="result.oneLine"></p>
      </div>

      <div class="mt-4 grid gap-3 sm:grid-cols-3">
        <div class="rounded-xl border border-sky-100 bg-sky-50 p-3">
          <p class="text-xs text-slate-500">打工倾向</p>
          <p class="mt-1 text-2xl font-bold text-sky-700" x-text="result.jobScore + '%' "></p>
        </div>
        <div class="rounded-xl border border-sky-100 bg-sky-50 p-3">
          <p class="text-xs text-slate-500">创业倾向</p>
          <p class="mt-1 text-2xl font-bold text-sky-700" x-text="result.bizScore + '%' "></p>
        </div>
        <div class="rounded-xl border border-sky-100 bg-sky-50 p-3">
          <p class="text-xs text-slate-500">建议路线</p>
          <p class="mt-1 text-base font-bold text-slate-800" x-text="result.route"></p>
        </div>
      </div>

      <p class="mt-4 text-sm leading-6 text-slate-700" x-text="result.summary"></p>

      <div class="mt-5 grid gap-3 sm:grid-cols-2">
        <template x-for="item in result.cards" :key="item.k">
          <div class="rounded-2xl border border-sky-100 bg-sky-50/50 p-4">
            <p class="text-xs text-slate-500" x-text="item.k"></p>
            <p class="mt-1 text-sm font-medium text-slate-800" x-text="item.v"></p>
          </div>
        </template>
      </div>

      <div class="mt-6 rounded-2xl border border-sky-200 bg-white p-4">
        <p class="text-sm font-semibold text-sky-800">下一步直接照着做</p>
        <ul class="mt-2 space-y-2 text-sm text-sky-900">
          <template x-for="tip in result.actions" :key="tip">
            <li x-text="'• ' + tip"></li>
          </template>
        </ul>
      </div>

      <button
        @click="reset()"
        class="mt-6 h-11 rounded-xl border border-sky-300 bg-slate-200/70 px-4 text-sm font-semibold text-sky-800 transition hover:bg-slate-100"
      >重测一次</button>
    </section>
  </main>

  <script>
    function quizApp() {
      const appBase = window.location.pathname.startsWith('/xiaohongshu') ? '/xiaohongshu' : '';
      return {
        appBase,
        totalStepsEstimate: 6,
        answeredCount: 0,
        progress: 0,
        started: false,
        lockState: false,
        finished: false,
        result: null,
        deviceId: '',
        quota: { free_remaining: 1, ad_credits: 0, can_play: true },
        adConfig: { enabled: false, ad_unit_id: '', demo_mode: false },
        currentQuestionId: 'q1',
        currentQuestion: null,
        branch: {
          risk: 'mid',
          role: 'mixed',
          mode: 'balanced'
        },
        scores: {
          risk: 0,
          execution: 0,
          stability: 0,
          growth: 0,
          autonomy: 0,
          resilience: 0
        },
        questions: {
          q1: {
            group: '风险偏好',
            title: '如果 2026 行业突然波动，你第一反应是？',
            desc: '选择最接近你真实行为的一项',
            options: [
              { id: 'A', text: '先保住当前岗位和现金流', tip: '偏稳健防守', score: { risk: 0, stability: 3 }, set: { risk: 'low' }, next: 'q2_stable' },
              { id: 'B', text: '先观望，再决定是否转向', score: { risk: 1, stability: 2 }, set: { risk: 'mid' }, next: 'q2_mix' },
              { id: 'C', text: '快速找新机会，准备切赛道', score: { risk: 3, growth: 2 }, set: { risk: 'high' }, next: 'q2_attack' },
              { id: 'D', text: '直接试错做自己的项目', score: { risk: 4, autonomy: 2 }, set: { risk: 'high' }, next: 'q2_attack' }
            ]
          },
          q2_stable: {
            group: '职业选择',
            title: '你最看重的工作属性是？',
            desc: '低风险路径',
            options: [
              { id: 'A', text: '五险一金+稳定晋升', score: { stability: 4 }, set: { role: 'job' }, next: 'q3_common' },
              { id: 'B', text: '稳定中带一点创新空间', score: { stability: 3, growth: 1 }, set: { role: 'mixed' }, next: 'q3_common' },
              { id: 'C', text: '高回报，不怕不稳定', score: { risk: 3, growth: 2 }, set: { role: 'biz' }, next: 'q3_common' }
            ]
          },
          q2_mix: {
            group: '职业选择',
            title: '对你来说，理想状态更像哪一种？',
            desc: '平衡路径',
            options: [
              { id: 'A', text: '主业稳定，副业小步试错', score: { stability: 2, autonomy: 1 }, set: { role: 'mixed' }, next: 'q3_common' },
              { id: 'B', text: '在公司内做核心项目并拿结果', score: { execution: 2, growth: 2 }, set: { role: 'job' }, next: 'q3_common' },
              { id: 'C', text: '希望逐步过渡到自己做业务', score: { autonomy: 2, growth: 2 }, set: { role: 'biz' }, next: 'q3_common' }
            ]
          },
          q2_attack: {
            group: '职业选择',
            title: '如果让你选 2026 的主线，你会选？',
            desc: '进攻路径',
            options: [
              { id: 'A', text: '快速搭建个人产品并验证', score: { autonomy: 3, execution: 2 }, set: { role: 'biz' }, next: 'q3_common' },
              { id: 'B', text: '加入高增长团队借势起飞', score: { growth: 3, execution: 1 }, set: { role: 'job' }, next: 'q3_common' },
              { id: 'C', text: '白天主业，夜晚搞项目', score: { resilience: 2, autonomy: 2 }, set: { role: 'mixed' }, next: 'q3_common' }
            ]
          },
          q3_common: {
            group: '执行力',
            title: '面对一个新机会，你通常会怎么做？',
            desc: '看你的行动模式',
            options: [
              { id: 'A', text: '收集信息，做完整计划再动', score: { stability: 2, execution: 1 }, next: 'q4_common' },
              { id: 'B', text: '先做最小测试，边做边改', score: { execution: 3, growth: 1 }, next: 'q4_common' },
              { id: 'C', text: '先抢窗口，再补流程', score: { risk: 2, execution: 2 }, next: 'q4_common' }
            ]
          },
          q4_common: {
            group: '抗压能力',
            title: '连续两周结果不理想，你会？',
            desc: '看复原速度',
            options: [
              { id: 'A', text: '先停下，减少损失', score: { stability: 2, resilience: 1 }, nextBy: { role: { biz: 'q5_biz', mixed: 'q5_mixed', job: 'q5_job' } } },
              { id: 'B', text: '复盘后调整策略继续做', score: { resilience: 3, execution: 1 }, nextBy: { role: { biz: 'q5_biz', mixed: 'q5_mixed', job: 'q5_job' } } },
              { id: 'C', text: '拉更多资源，把局面打回来', score: { resilience: 2, autonomy: 2 }, nextBy: { role: { biz: 'q5_biz', mixed: 'q5_mixed', job: 'q5_job' } } }
            ]
          },
          q5_job: {
            group: '组织协作',
            title: '你在团队里更像哪类角色？',
            desc: '职业路径分支',
            options: [
              { id: 'A', text: '流程稳定器：把事做稳', score: { stability: 3 }, next: 'q6_final' },
              { id: 'B', text: '推进器：拉齐资源拿结果', score: { execution: 3, growth: 1 }, next: 'q6_final' },
              { id: 'C', text: '创新者：不断提出新打法', score: { growth: 3, autonomy: 1 }, next: 'q6_final' }
            ]
          },
          q5_mixed: {
            group: '双轨发展',
            title: '主业和副业冲突时你会怎么排优先级？',
            desc: '混合路径分支',
            options: [
              { id: 'A', text: '主业优先，副业保持续', score: { stability: 3, autonomy: 1 }, next: 'q6_final' },
              { id: 'B', text: '看阶段目标动态切换', score: { execution: 2, resilience: 2 }, next: 'q6_final' },
              { id: 'C', text: '副业冲刺，主业兜底', score: { autonomy: 3, risk: 2 }, next: 'q6_final' }
            ]
          },
          q5_biz: {
            group: '创业决策',
            title: '你更愿意用哪种方式做创业起盘？',
            desc: '创业路径分支',
            options: [
              { id: 'A', text: '先小模型验证，再放大', score: { execution: 3, risk: 1 }, set: { mode: 'lean' }, next: 'q6_final' },
              { id: 'B', text: '先做品牌声量，再导入产品', score: { growth: 3, autonomy: 2 }, set: { mode: 'brand' }, next: 'q6_final' },
              { id: 'C', text: '重投放快起量，抢时间窗口', score: { risk: 3, execution: 2 }, set: { mode: 'aggressive' }, next: 'q6_final' }
            ]
          },
          q6_final: {
            group: '2026目标',
            title: '2026 年你最想拿到的确定性是什么？',
            desc: '最后一题',
            options: [
              { id: 'A', text: '稳定上涨的年收入', score: { stability: 3, growth: 1 }, next: 'finish' },
              { id: 'B', text: '可复制的个人能力和作品', score: { growth: 2, autonomy: 2 }, next: 'finish' },
              { id: 'C', text: '属于自己的现金流系统', score: { autonomy: 3, execution: 2 }, next: 'finish' }
            ]
          }
        },

        async init() {
          this.currentQuestion = this.questions[this.currentQuestionId];
          this.deviceId = localStorage.getItem('quiz_device_id') || `d_${Date.now()}_${Math.random().toString(36).slice(2, 8)}`;
          localStorage.setItem('quiz_device_id', this.deviceId);
          await this.refreshQuota();
          const adRes = await fetch(`${this.appBase}/api/quiz/ad-config`);
          this.adConfig = await adRes.json();
          this.lockState = !this.quota.can_play;
        },

        async refreshQuota() {
          const res = await fetch(`${this.appBase}/api/quiz/quota/${this.deviceId}`);
          this.quota = await res.json();
        },

        async startQuiz() {
          const res = await fetch(`${this.appBase}/api/quiz/consume`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ device_id: this.deviceId })
          });
          const data = await res.json();
          this.quota = data.quota || this.quota;
          if (!data.success) {
            this.lockState = true;
            this.started = false;
            return;
          }
          this.started = true;
          this.lockState = false;
        },

        async watchAdUnlock() {
          if (!this.adConfig.enabled && !this.adConfig.demo_mode) {
            alert('激励广告未配置，请先在服务端配置 WEAPP_REWARDED_AD_UNIT_ID');
            return;
          }

          const ticketRes = await fetch(`${this.appBase}/api/quiz/ad-ticket`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ device_id: this.deviceId })
          });
          const ticket = await ticketRes.json();
          if (!ticket.success) {
            alert(ticket.error || '获取广告票据失败');
            return;
          }

          let watched = false;
          if (window.__WEAPP_AD_BRIDGE__ && typeof window.__WEAPP_AD_BRIDGE__.showRewardedAd === 'function') {
            watched = await window.__WEAPP_AD_BRIDGE__.showRewardedAd(this.adConfig.ad_unit_id);
          } else if (this.adConfig.demo_mode) {
            await new Promise((resolve) => setTimeout(resolve, 2500));
            watched = true;
          } else {
            alert('请在小程序内打开，才能调用真实激励广告');
            return;
          }

          if (!watched) {
            alert('广告未完整观看，暂未解锁');
            return;
          }

          const verifyRes = await fetch(`${this.appBase}/api/quiz/unlock-ad-verify`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              device_id: this.deviceId,
              ticket_id: ticket.ticket_id,
              signature: ticket.signature
            })
          });
          const verifyData = await verifyRes.json();
          if (!verifyData.success) {
            alert(verifyData.error || '广告校验失败');
            return;
          }

          this.quota = verifyData.quota;
          this.lockState = !this.quota.can_play;
        },

        selectOption(opt) {
          this.answeredCount += 1;
          this.applyScore(opt.score || {});
          this.applyBranch(opt.set || {});

          let nextQuestionId = opt.next || null;
          if (!nextQuestionId && opt.nextBy && opt.nextBy.role) {
            nextQuestionId = opt.nextBy.role[this.branch.role] || opt.nextBy.role.mixed;
          }

          if (!nextQuestionId || nextQuestionId === 'finish') {
            this.finish();
            return;
          }

          this.currentQuestionId = nextQuestionId;
          this.currentQuestion = this.questions[this.currentQuestionId];
          this.progress = Math.min(this.answeredCount / this.totalStepsEstimate, 1);
        },

        applyScore(delta) {
          Object.keys(delta).forEach((k) => {
            this.scores[k] = (this.scores[k] || 0) + delta[k];
          });
        },

        applyBranch(nextBranch) {
          Object.keys(nextBranch).forEach((k) => {
            this.branch[k] = nextBranch[k];
          });
        },

        finish() {
          this.progress = 1;
          this.finished = true;
          this.result = this.generateResult();
        },

        generateResult() {
          const totalCore = this.scores.risk + this.scores.autonomy + this.scores.execution + this.scores.stability;
          const jobPower = this.scores.stability + this.scores.execution + (this.branch.role === 'job' ? 3 : 0);
          const bizPower = this.scores.autonomy + this.scores.risk + this.scores.growth + (this.branch.role === 'biz' ? 3 : 0);

          let type = 'mixed';
          if (jobPower - bizPower >= 4) type = 'job';
          if (bizPower - jobPower >= 4) type = 'biz';

          if (type === 'job') {
            return {
              title: '稳健打工进阶型',
              oneLine: '你是“先稳住，再升级”的选手，适合在平台内快速抬升身价。',
              route: '主业冲刺型',
              jobScore: 78,
              bizScore: 22,
              summary: '你在组织体系里更容易把能力转化成确定性回报。2026 适合走“职位升级 + 关键项目 + 可迁移能力”路线。',
              cards: [
                { k: '主引擎', v: '稳定现金流 + 团队资源协同' },
                { k: '优势', v: '执行靠谱，抗波动能力强' },
                { k: '风险点', v: '过于保守，错过增量窗口' },
                { k: '建议策略', v: '主业深耕，保留 20% 精力做试验型副项目' }
              ],
              actions: [
                '先拿下一个可量化的大结果，建立 2026 年职场杠杆。',
                '每月固定做一次外部机会扫描，避免信息闭环。',
                '用作品集思维沉淀成果，给未来跳级或跳槽留后手。'
              ]
            };
          }

          if (type === 'biz') {
            const modeText = this.branch.mode === 'aggressive'
              ? '进攻型起盘'
              : this.branch.mode === 'brand'
                ? '品牌型起盘'
                : '精益型起盘';

            return {
              title: '创业增长型',
              oneLine: '你天生偏创业脑，适合自己做盘子，但要控制节奏。',
              route: '创业主线型',
              jobScore: 28,
              bizScore: 72,
              summary: '你有较强自主驱动和机会嗅觉，适合在 2026 做自己的业务。关键是控制节奏，别把试错变成硬扛。',
              cards: [
                { k: '主引擎', v: '自主决策 + 快速迭代' },
                { k: '当前模式', v: modeText },
                { k: '优势', v: '敢做决策，行动速度快' },
                { k: '风险点', v: '现金流管理与耐心不足' }
              ],
              actions: [
                '先做可验证的小闭环：产品-成交-复购。',
                '设置明确止损线，避免单点 All in。',
                '每周复盘一次投产比，把增长建立在数据上。'
              ]
            };
          }

          return {
            title: '职场创业双修型',
            oneLine: '你最适合“双轨并行”：主业保底，副业做增量。',
            route: '双轨平衡型',
            jobScore: 52,
            bizScore: 48,
            summary: '你既需要稳定底盘，也具备创业潜质。2026 最优解是双轨并行：主业做确定性，副业做增长性。',
            cards: [
              { k: '主引擎', v: '双轨结构：稳定 + 增量' },
              { k: '优势', v: '平衡能力强，进退有空间' },
              { k: '风险点', v: '精力分散，目标不够聚焦' },
              { k: '建议策略', v: '季度一个主目标，避免同时开太多战线' }
            ],
            actions: [
              '把副业限定在单一赛道，先跑出第一个可复制模型。',
              '主业优先拿高含金量项目，形成个人品牌护城河。',
              '按季度做资源盘点：时间、现金、关系网，动态调整。'
            ]
          };
        },

        async reset() {
          this.answeredCount = 0;
          this.progress = 0;
          this.started = false;
          this.finished = false;
          this.currentQuestionId = 'q1';
          this.currentQuestion = this.questions[this.currentQuestionId];
          this.branch = { risk: 'mid', role: 'mixed', mode: 'balanced' };
          this.scores = { risk: 0, execution: 0, stability: 0, growth: 0, autonomy: 0, resilience: 0 };
          this.result = null;
          await this.refreshQuota();
          this.lockState = !this.quota.can_play;
        }
      };
    }
  </script>
</body>
</html>
